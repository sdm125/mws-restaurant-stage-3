var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}();function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var DBHelper=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getLocalDatabase",value:function(){return idb.open("restaurant-reviews-data",1,function(e){e.createObjectStore("restaurant-reviews",{keyPath:"id"})})}},{key:"fetchRestaurants",value:function(t){fetch(e.DATABASE_URL("allRestaurants")).then(function(e){return e.ok||Error(e.statusText),e.json()}).then(function(n){t(null,n),e.getLocalDatabase().then(function(e){var t=e.transaction("restaurant-reviews","readwrite").objectStore("restaurant-reviews"),r=!0,o=!1,a=void 0;try{for(var i,u=n[Symbol.iterator]();!(r=(i=u.next()).done);r=!0){var s=i.value;t.put(s)}}catch(e){o=!0,a=e}finally{try{!r&&u.return&&u.return()}finally{if(o)throw a}}})}).catch(function(n){e.getLocalDatabase().then(function(e){return e.transaction("restaurant-reviews").objectStore("restaurant-reviews").getAll()}).then(function(e){t(null,e)})})}},{key:"fetchRestaurantById",value:function(t,n){e.fetchRestaurants(function(e,r){if(e)n(e,null);else{var o=r.find(function(e){return e.id==t});o?n(null,o):n("Restaurant does not exist",null)}})}},{key:"fetchRestaurantByCuisine",value:function(t,n){e.fetchRestaurants(function(e,r){if(e)n(e,null);else{var o=r.filter(function(e){return e.cuisine_type==t});n(null,o)}})}},{key:"fetchRestaurantByNeighborhood",value:function(t,n){e.fetchRestaurants(function(e,r){if(e)n(e,null);else{var o=r.filter(function(e){return e.neighborhood==t});n(null,o)}})}},{key:"fetchRestaurantByCuisineAndNeighborhood",value:function(t,n,r){e.fetchRestaurants(function(e,o){if(e)r(e,null);else{var a=o;"all"!=t&&(a=a.filter(function(e){return e.cuisine_type==t})),"all"!=n&&(a=a.filter(function(e){return e.neighborhood==n})),r(null,a)}})}},{key:"fetchNeighborhoods",value:function(t){e.fetchRestaurants(function(e,n){if(e)t(e,null);else{var r=n.map(function(e,t){return n[t].neighborhood}),o=r.filter(function(e,t){return r.indexOf(e)==t});t(null,o)}})}},{key:"fetchCuisines",value:function(t){e.fetchRestaurants(function(e,n){if(e)t(e,null);else{var r=n.map(function(e,t){return n[t].cuisine_type}),o=r.filter(function(e,t){return r.indexOf(e)==t});t(null,o)}})}},{key:"urlForRestaurant",value:function(e){return"./restaurant.html?id="+e.id}},{key:"imageUrlForRestaurant",value:function(e,t){return e.photograph?"sm"===t?"/img/"+e.photograph+"_400.jpg":"/img/"+e.photograph+"_800.jpg":"sm"===t?"/img/default_400.jpg":"/img/default_800.jpg"}},{key:"mapMarkerForRestaurant",value:function(t,n){return new google.maps.Marker({position:t.latlng,title:t.name,url:e.urlForRestaurant(t),map:n,animation:google.maps.Animation.DROP})}},{key:"DATABASE_URL",get:function(){return"http://localhost:1337/restaurants/"}}]),e}();!function(){function e(e){return new Promise(function(t,n){e.onsuccess=function(){t(e.result)},e.onerror=function(){n(e.error)}})}function t(t,n,r){var o,a=new Promise(function(a,i){e(o=t[n].apply(t,r)).then(a,i)});return a.request=o,a}function n(e,t,n){n.forEach(function(n){Object.defineProperty(e.prototype,n,{get:function(){return this[t][n]},set:function(e){this[t][n]=e}})})}function r(e,n,r,o){o.forEach(function(o){o in r.prototype&&(e.prototype[o]=function(){return t(this[n],o,arguments)})})}function o(e,t,n,r){r.forEach(function(r){r in n.prototype&&(e.prototype[r]=function(){return this[t][r].apply(this[t],arguments)})})}function a(e,n,r,o){o.forEach(function(o){o in r.prototype&&(e.prototype[o]=function(){return e=this[n],(r=t(e,o,arguments)).then(function(e){if(e)return new u(e,r.request)});var e,r})})}function i(e){this._index=e}function u(e,t){this._cursor=e,this._request=t}function s(e){this._store=e}function c(e){this._tx=e,this.complete=new Promise(function(t,n){e.oncomplete=function(){t()},e.onerror=function(){n(e.error)},e.onabort=function(){n(e.error)}})}function l(e,t,n){this._db=e,this.oldVersion=t,this.transaction=new c(n)}function d(e){this._db=e}n(i,"_index",["name","keyPath","multiEntry","unique"]),r(i,"_index",IDBIndex,["get","getKey","getAll","getAllKeys","count"]),a(i,"_index",IDBIndex,["openCursor","openKeyCursor"]),n(u,"_cursor",["direction","key","primaryKey","value"]),r(u,"_cursor",IDBCursor,["update","delete"]),["advance","continue","continuePrimaryKey"].forEach(function(t){t in IDBCursor.prototype&&(u.prototype[t]=function(){var n=this,r=arguments;return Promise.resolve().then(function(){return n._cursor[t].apply(n._cursor,r),e(n._request).then(function(e){if(e)return new u(e,n._request)})})})}),s.prototype.createIndex=function(){return new i(this._store.createIndex.apply(this._store,arguments))},s.prototype.index=function(){return new i(this._store.index.apply(this._store,arguments))},n(s,"_store",["name","keyPath","indexNames","autoIncrement"]),r(s,"_store",IDBObjectStore,["put","add","delete","clear","get","getAll","getKey","getAllKeys","count"]),a(s,"_store",IDBObjectStore,["openCursor","openKeyCursor"]),o(s,"_store",IDBObjectStore,["deleteIndex"]),c.prototype.objectStore=function(){return new s(this._tx.objectStore.apply(this._tx,arguments))},n(c,"_tx",["objectStoreNames","mode"]),o(c,"_tx",IDBTransaction,["abort"]),l.prototype.createObjectStore=function(){return new s(this._db.createObjectStore.apply(this._db,arguments))},n(l,"_db",["name","version","objectStoreNames"]),o(l,"_db",IDBDatabase,["deleteObjectStore","close"]),d.prototype.transaction=function(){return new c(this._db.transaction.apply(this._db,arguments))},n(d,"_db",["name","version","objectStoreNames"]),o(d,"_db",IDBDatabase,["close"]),["openCursor","openKeyCursor"].forEach(function(e){[s,i].forEach(function(t){e in t.prototype&&(t.prototype[e.replace("open","iterate")]=function(){var t,n=(t=arguments,Array.prototype.slice.call(t)),r=n[n.length-1],o=this._store||this._index,a=o[e].apply(o,n.slice(0,-1));a.onsuccess=function(){r(a.result)}})})}),[i,s].forEach(function(e){e.prototype.getAll||(e.prototype.getAll=function(e,t){var n=this,r=[];return new Promise(function(o){n.iterateCursor(e,function(e){e?(r.push(e.value),void 0===t||r.length!=t?e.continue():o(r)):o(r)})})})});var f={open:function(e,n,r){var o=t(indexedDB,"open",[e,n]),a=o.request;return a&&(a.onupgradeneeded=function(e){r&&r(new l(a.result,e.oldVersion,a.transaction))}),o.then(function(e){return new d(e)})},delete:function(e){return t(indexedDB,"deleteDatabase",[e])}};"undefined"!=typeof module?(module.exports=f,module.exports.default=module.exports):self.idb=f}();var restaurants=void 0,neighborhoods=void 0,cuisines=void 0,map=void 0,markers=[],home="/"===window.location.pathname;console.log("here"),document.addEventListener("DOMContentLoaded",function(e){fetchNeighborhoods(),fetchCuisines(),registerServiceWorker()}),window.addEventListener("load",function(){document.querySelectorAll("iframe")[0].title="Restaurant map"}),registerServiceWorker=function(){navigator.serviceWorker&&navigator.serviceWorker.register("/sw.js").then(function(){console.log("Service worked registered!")}).catch(function(e){console.log("Registration failed!")})},fetchNeighborhoods=function(){DBHelper.fetchNeighborhoods(function(e,t){e?console.error(e):(self.neighborhoods=t,fillNeighborhoodsHTML())})},fillNeighborhoodsHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.neighborhoods,t=document.getElementById("neighborhoods-select");e.forEach(function(e){var n=document.createElement("option");n.innerHTML=e,n.value=e,home&&t.append(n)})},fetchCuisines=function(){DBHelper.fetchCuisines(function(e,t){e?console.error(e):(self.cuisines=t,fillCuisinesHTML())})},fillCuisinesHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.cuisines,t=document.getElementById("cuisines-select");e.forEach(function(e){var n=document.createElement("option");n.innerHTML=e,n.value=e,home&&t.append(n)})},window.initMap=function(){self.map=new google.maps.Map(document.querySelector(".map"),{zoom:12,center:{lat:40.722216,lng:-73.987501},scrollwheel:!1}),updateRestaurants()},updateRestaurants=function(){var e=document.getElementById("cuisines-select"),t=document.getElementById("neighborhoods-select"),n=e.selectedIndex,r=t.selectedIndex,o=e[n].value,a=t[r].value;DBHelper.fetchRestaurantByCuisineAndNeighborhood(o,a,function(e,t){e?console.error(e):(resetRestaurants(t),fillRestaurantsHTML())})},document.getElementById("neighborhoods-select")&&document.getElementById("neighborhoods-select").addEventListener("change",function(){updateRestaurants()}),document.getElementById("cuisines-select")&&document.getElementById("cuisines-select").addEventListener("change",function(){updateRestaurants()}),resetRestaurants=function(e){self.restaurants=[],document.querySelector(".restaurants-list").innerHTML="",self.markers.forEach(function(e){return e.setMap(null)}),self.markers=[],self.restaurants=e},fillRestaurantsHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurants,t=document.querySelector(".restaurants-list");e.forEach(function(e){t.append(createRestaurantHTML(e))}),addMarkersToMap()},createRestaurantHTML=function(e){var t=document.createElement("li"),n=document.createElement("div"),r=document.createElement("picture"),o=document.createElement("source"),a=document.createElement("source"),i=document.createElement("img");o.className="restaurant-img",o.alt=e.name,o.media="(min-width: 500px)",o.srcset=DBHelper.imageUrlForRestaurant(e,"lg"),r.append(o),a.className="restaurant-img",a.alt=e.name,a.media="(max-width: 500px)",a.srcset=DBHelper.imageUrlForRestaurant(e,"sm"),r.append(a),i.className="restaurant-img",i.alt=e.name,i.src=DBHelper.imageUrlForRestaurant(e,"lg"),r.append(i),t.append(r);var u=document.createElement("h2");u.innerHTML=e.name,n.append(u);var s=document.createElement("p");s.innerHTML=e.neighborhood,s.classList+="neighborhood",n.append(s);var c=document.createElement("p");c.innerHTML=e.address,n.append(c);var l=document.createElement("a");return l.innerHTML="View Details",l.setAttribute("aria-label",e.name),l.href=DBHelper.urlForRestaurant(e),n.append(l),t.append(n),t},addMarkersToMap=function(){(arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurants).forEach(function(e){var t=DBHelper.mapMarkerForRestaurant(e,self.map);google.maps.event.addListener(t,"click",function(){window.location.href=t.url}),self.markers.push(t)})};var restaurant=void 0,mapInfo=void 0;"/restaurant.html"===window.location.pathname&&(window.initMap=function(){fetchRestaurantFromURL(function(e,t){e?console.error(e):(self.mapInfo=new google.maps.Map(document.querySelector(".map"),{zoom:16,center:t.latlng,scrollwheel:!1}),fillBreadcrumb(),DBHelper.mapMarkerForRestaurant(self.restaurant,self.mapInfo))})}),fetchRestaurantFromURL=function(e){if(self.restaurant)e(null,self.restaurant);else{var t=getParameterByName("id");t?DBHelper.fetchRestaurantById(t,function(t,n){self.restaurant=n,n?(fillRestaurantHTML(),e(null,n)):console.error(t)}):(error="No restaurant id in URL",e(error,null))}},fillRestaurantHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurant;document.querySelector(".restaurant-name").innerHTML=e.name,document.querySelector(".restaurant-address").innerHTML=e.address;var t=document.createElement("source"),n=document.createElement("source"),r=document.createElement("img"),o=document.querySelector(".restaurant-img");t.className="restaurant-img",t.alt=e.alt,t.media="(min-width: 500px)",t.srcset=DBHelper.imageUrlForRestaurant(e,"lg"),o.append(t),n.className="restaurant-img",n.alt=e.alt,n.media="(max-width: 500px)",n.srcset=DBHelper.imageUrlForRestaurant(e,"sm"),o.append(n),r.className="restaurant-img",r.alt=e.alt,r.src=DBHelper.imageUrlForRestaurant(e,"lg"),o.append(r),document.querySelector(".restaurant-cuisine").innerHTML=e.cuisine_type,e.operating_hours&&fillRestaurantHoursHTML(),fillReviewsHTML()},fillRestaurantHoursHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurant.operating_hours,t=document.querySelector(".restaurant-hours");for(var n in e){var r=document.createElement("tr"),o=document.createElement("td");o.innerHTML=n,r.appendChild(o);var a=document.createElement("td");a.innerHTML=e[n],r.appendChild(a),t.appendChild(r)}},fillReviewsHTML=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurant.reviews,t=document.querySelector(".reviews-container");if(!e){var n=document.createElement("p");return n.innerHTML="No reviews yet!",void t.appendChild(n)}var r=document.querySelector(".reviews-list");e.forEach(function(e){r.appendChild(createReviewHTML(e))}),t.appendChild(r)},createReviewHTML=function(e){var t=document.createElement("li"),n=document.createElement("p");n.innerHTML=e.name,t.appendChild(n);var r=document.createElement("p");r.innerHTML=e.date,t.appendChild(r);var o=document.createElement("p");o.innerHTML="Rating: "+e.rating,t.appendChild(o);var a=document.createElement("p");return a.innerHTML=e.comments,t.appendChild(a),t},fillBreadcrumb=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:self.restaurant,t=document.querySelector(".breadcrumb"),n=document.createElement("li");n.innerHTML=e.name,t.appendChild(n)},getParameterByName=function(e,t){t||(t=window.location.href),e=e.replace(/[\[\]]/g,"\\$&");var n=new RegExp("[?&]"+e+"(=([^&#]*)|&|#|$)").exec(t);return n?n[2]?decodeURIComponent(n[2].replace(/\+/g," ")):"":null};
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRiaGVscGVyLmpzIiwiaWRiLmpzIiwibWFpbi5qcyIsInJlc3RhdXJhbnRfaW5mby5qcyJdLCJuYW1lcyI6WyJEQkhlbHBlciIsImlkYiIsIm9wZW4iLCJ1cGdyYWRlRGIiLCJjcmVhdGVPYmplY3RTdG9yZSIsImtleVBhdGgiLCJjYWxsYmFjayIsImZldGNoIiwiREFUQUJBU0VfVVJMIiwidGhlbiIsInJlc3BvbnNlIiwib2siLCJFcnJvciIsInN0YXR1c1RleHQiLCJqc29uIiwicmVzdGF1cmFudHMiLCJnZXRMb2NhbERhdGFiYXNlIiwiZGIiLCJyZXN0YXVyYW50c1N0b3JlIiwidHJhbnNhY3Rpb24iLCJvYmplY3RTdG9yZSIsIl9pdGVyYXRvck5vcm1hbENvbXBsZXRpb24iLCJfZGlkSXRlcmF0b3JFcnJvciIsIl9pdGVyYXRvckVycm9yIiwidW5kZWZpbmVkIiwiX3N0ZXAiLCJfaXRlcmF0b3IiLCJTeW1ib2wiLCJpdGVyYXRvciIsIm5leHQiLCJkb25lIiwicmVzdGF1cmFudCIsInZhbHVlIiwicHV0IiwiZXJyIiwicmV0dXJuIiwiY2F0Y2giLCJlcnJvciIsImdldEFsbCIsImlkIiwiZmV0Y2hSZXN0YXVyYW50cyIsImZpbmQiLCJyIiwiY3Vpc2luZSIsInJlc3VsdHMiLCJmaWx0ZXIiLCJjdWlzaW5lX3R5cGUiLCJuZWlnaGJvcmhvb2QiLCJuZWlnaGJvcmhvb2RzIiwibWFwIiwidiIsImkiLCJ1bmlxdWVOZWlnaGJvcmhvb2RzIiwiaW5kZXhPZiIsImN1aXNpbmVzIiwidW5pcXVlQ3Vpc2luZXMiLCJzaXplIiwicGhvdG9ncmFwaCIsImdvb2dsZSIsIm1hcHMiLCJNYXJrZXIiLCJwb3NpdGlvbiIsImxhdGxuZyIsInRpdGxlIiwibmFtZSIsInVybCIsInVybEZvclJlc3RhdXJhbnQiLCJhbmltYXRpb24iLCJBbmltYXRpb24iLCJEUk9QIiwicHJvbWlzaWZ5UmVxdWVzdCIsInJlcXVlc3QiLCJQcm9taXNlIiwicmVzb2x2ZSIsInJlamVjdCIsIm9uc3VjY2VzcyIsInJlc3VsdCIsIm9uZXJyb3IiLCJwcm9taXNpZnlSZXF1ZXN0Q2FsbCIsIm9iaiIsIm1ldGhvZCIsImFyZ3MiLCJwIiwiYXBwbHkiLCJwcm94eVByb3BlcnRpZXMiLCJQcm94eUNsYXNzIiwidGFyZ2V0UHJvcCIsInByb3BlcnRpZXMiLCJmb3JFYWNoIiwicHJvcCIsIk9iamVjdCIsImRlZmluZVByb3BlcnR5IiwicHJvdG90eXBlIiwiZ2V0IiwidGhpcyIsInNldCIsInZhbCIsInByb3h5UmVxdWVzdE1ldGhvZHMiLCJDb25zdHJ1Y3RvciIsImFyZ3VtZW50cyIsInByb3h5TWV0aG9kcyIsInByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMiLCJDdXJzb3IiLCJJbmRleCIsImluZGV4IiwiX2luZGV4IiwiY3Vyc29yIiwiX2N1cnNvciIsIl9yZXF1ZXN0IiwiT2JqZWN0U3RvcmUiLCJzdG9yZSIsIl9zdG9yZSIsIlRyYW5zYWN0aW9uIiwiaWRiVHJhbnNhY3Rpb24iLCJfdHgiLCJjb21wbGV0ZSIsIm9uY29tcGxldGUiLCJvbmFib3J0IiwiVXBncmFkZURCIiwib2xkVmVyc2lvbiIsIl9kYiIsIkRCIiwiSURCSW5kZXgiLCJJREJDdXJzb3IiLCJtZXRob2ROYW1lIiwiY3JlYXRlSW5kZXgiLCJJREJPYmplY3RTdG9yZSIsIklEQlRyYW5zYWN0aW9uIiwiSURCRGF0YWJhc2UiLCJmdW5jTmFtZSIsInJlcGxhY2UiLCJhcnIiLCJBcnJheSIsInNsaWNlIiwiY2FsbCIsImxlbmd0aCIsIm5hdGl2ZU9iamVjdCIsInF1ZXJ5IiwiY291bnQiLCJpbnN0YW5jZSIsIml0ZW1zIiwiaXRlcmF0ZUN1cnNvciIsInB1c2giLCJjb250aW51ZSIsImV4cCIsInZlcnNpb24iLCJ1cGdyYWRlQ2FsbGJhY2siLCJpbmRleGVkREIiLCJvbnVwZ3JhZGVuZWVkZWQiLCJldmVudCIsImRlbGV0ZSIsIm1vZHVsZSIsImV4cG9ydHMiLCJkZWZhdWx0Iiwic2VsZiIsIm1hcmtlcnMiLCJob21lIiwid2luZG93IiwibG9jYXRpb24iLCJwYXRobmFtZSIsImNvbnNvbGUiLCJsb2ciLCJkb2N1bWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJmZXRjaE5laWdoYm9yaG9vZHMiLCJmZXRjaEN1aXNpbmVzIiwicmVnaXN0ZXJTZXJ2aWNlV29ya2VyIiwicXVlcnlTZWxlY3RvckFsbCIsIm5hdmlnYXRvciIsInNlcnZpY2VXb3JrZXIiLCJyZWdpc3RlciIsImZpbGxOZWlnaGJvcmhvb2RzSFRNTCIsInNlbGVjdCIsImdldEVsZW1lbnRCeUlkIiwib3B0aW9uIiwiY3JlYXRlRWxlbWVudCIsImlubmVySFRNTCIsImFwcGVuZCIsImZpbGxDdWlzaW5lc0hUTUwiLCJpbml0TWFwIiwiTWFwIiwicXVlcnlTZWxlY3RvciIsInpvb20iLCJjZW50ZXIiLCJsYXQiLCJsbmciLCJzY3JvbGx3aGVlbCIsInVwZGF0ZVJlc3RhdXJhbnRzIiwiY1NlbGVjdCIsIm5TZWxlY3QiLCJjSW5kZXgiLCJzZWxlY3RlZEluZGV4IiwibkluZGV4IiwiZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lQW5kTmVpZ2hib3Job29kIiwicmVzZXRSZXN0YXVyYW50cyIsImZpbGxSZXN0YXVyYW50c0hUTUwiLCJtIiwic2V0TWFwIiwidWwiLCJjcmVhdGVSZXN0YXVyYW50SFRNTCIsImFkZE1hcmtlcnNUb01hcCIsImxpIiwiY29udGFpbmVyIiwicGljdHVyZSIsInNvdXJjZUxnIiwic291cmNlU20iLCJpbWFnZSIsImNsYXNzTmFtZSIsImFsdCIsIm1lZGlhIiwic3Jjc2V0IiwiaW1hZ2VVcmxGb3JSZXN0YXVyYW50Iiwic3JjIiwiY2xhc3NMaXN0IiwiYWRkcmVzcyIsIm1vcmUiLCJzZXRBdHRyaWJ1dGUiLCJocmVmIiwibWFya2VyIiwibWFwTWFya2VyRm9yUmVzdGF1cmFudCIsImFkZExpc3RlbmVyIiwibWFwSW5mbyIsImZldGNoUmVzdGF1cmFudEZyb21VUkwiLCJmaWxsQnJlYWRjcnVtYiIsImdldFBhcmFtZXRlckJ5TmFtZSIsImZldGNoUmVzdGF1cmFudEJ5SWQiLCJmaWxsUmVzdGF1cmFudEhUTUwiLCJkZWZhdWx0SW1nIiwib3BlcmF0aW5nX2hvdXJzIiwiZmlsbFJlc3RhdXJhbnRIb3Vyc0hUTUwiLCJmaWxsUmV2aWV3c0hUTUwiLCJvcGVyYXRpbmdIb3VycyIsImhvdXJzIiwia2V5Iiwicm93IiwiZGF5IiwiYXBwZW5kQ2hpbGQiLCJ0aW1lIiwicmV2aWV3cyIsIm5vUmV2aWV3cyIsInJldmlldyIsImNyZWF0ZVJldmlld0hUTUwiLCJkYXRlIiwicmF0aW5nIiwiY29tbWVudHMiLCJicmVhZGNydW1iIiwiUmVnRXhwIiwiZXhlYyIsImRlY29kZVVSSUNvbXBvbmVudCJdLCJtYXBwaW5ncyI6Im9YQUlBQSw4SEFlQSxPQUFBQyxJQUFBQyxLQUFBLDBCQUFBLEVBQUEsU0FBQUMsR0FDQUEsRUFBQUMsa0JBQUEscUJBQUEsQ0FBQUMsUUFBQSxrREFPQUMsR0FDQUMsTUFBQVAsRUFBQVEsYUFBQSxtQkFDQUMsS0FBQSxTQUFBQyxHQUVBLE9BREFBLEVBQUFDLElBQUFDLE1BQUFGLEVBQUFHLFlBQ0FILEVBQUFJLFNBRUFMLEtBQUEsU0FBQU0sR0FDQVQsRUFBQSxLQUFBUyxHQUNBZixFQUFBZ0IsbUJBQUFQLEtBQUEsU0FBQVEsR0FDQSxJQUNBQyxFQURBRCxFQUFBRSxZQUFBLHFCQUFBLGFBQ0FDLFlBQUEsc0JBRkFDLEdBQUEsRUFBQUMsR0FBQSxFQUFBQyxPQUFBQyxFQUFBLElBSUEsSUFBQSxJQUFBQyxFQUFBQyxFQUFBWCxFQUFBWSxPQUFBQyxjQUFBUCxHQUFBSSxFQUFBQyxFQUFBRyxRQUFBQyxNQUFBVCxHQUFBLEVBQUEsQ0FBQSxJQUFBVSxFQUFBTixFQUFBTyxNQUNBZCxFQUFBZSxJQUFBRixJQUxBLE1BQUFHLEdBQUFaLEdBQUEsRUFBQUMsRUFBQVcsRUFBQSxRQUFBLEtBQUFiLEdBQUFLLEVBQUFTLFFBQUFULEVBQUFTLFNBQUEsUUFBQSxHQUFBYixFQUFBLE1BQUFDLFFBU0FhLE1BQUEsU0FBQUMsR0FFQXJDLEVBQUFnQixtQkFB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R0FFQTNDLEdBTUFzQixlQUFBLFdBQUEsSUFBQWhNLEVBQUFvRSxVQUFBb0MsT0FBQSxRQUFBL0csSUFBQTJFLFVBQUEsR0FBQUEsVUFBQSxHQUFBdUQsS0FBQTNILFdBQ0FzTixFQUFBbkYsU0FBQW1CLGNBQUEsZUFDQW9CLEVBQUF2QyxTQUFBYSxjQUFBLE1BQ0EwQixFQUFBekIsVUFBQWpKLEVBQUFpQyxLQUNBcUwsRUFBQVQsWUFBQW5DLElBTUF1QixtQkFBQSxTQUFBaEssRUFBQUMsR0FDQUEsSUFDQUEsRUFBQTRGLE9BQUFDLFNBQUEyRCxNQUNBekosRUFBQUEsRUFBQWtFLFFBQUEsVUFBQSxRQUNBLElBQ0F0RixFQURBLElBQUEwTSxPQUFBLE9BQUF0TCxFQUFBLHFCQUNBdUwsS0FBQXRMLEdBQ0EsT0FBQXJCLEVBRUFBLEVBQUEsR0FFQTRNLG1CQUFBNU0sRUFBQSxHQUFBc0YsUUFBQSxNQUFBLE1BREEsR0FGQSIsImZpbGUiOiJzY3JpcHRzLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbIi8qKlxyXG4gKiBDb21tb24gZGF0YWJhc2UgaGVscGVyIGZ1bmN0aW9ucy5cclxuICovXHJcblxyXG5jbGFzcyBEQkhlbHBlciB7XHJcblxyXG4gIC8qKlxyXG4gICAqIERhdGFiYXNlIFVSTC5cclxuICAgKiBDaGFuZ2UgdGhpcyB0byByZXN0YXVyYW50cy5qc29uIGZpbGUgbG9jYXRpb24gb24geW91ciBzZXJ2ZXIuXHJcbiAgICovXHJcbiAgc3RhdGljIGdldCBEQVRBQkFTRV9VUkwoKSB7XHJcbiAgICBjb25zdCBwb3J0ID0gMTMzNztcclxuICAgIHJldHVybiBgaHR0cDovL2xvY2FsaG9zdDoke3BvcnR9L3Jlc3RhdXJhbnRzL2A7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBDYWNoZSByZXN0YXVyYW50IEpTT04gaW4gaW5kZXhEQlxyXG4gICAqL1xyXG4gIHN0YXRpYyBnZXRMb2NhbERhdGFiYXNlKCkge1xyXG4gICAgcmV0dXJuIGlkYi5vcGVuKCdyZXN0YXVyYW50LXJldmlld3MtZGF0YScsIDEsICh1cGdyYWRlRGIpID0+IHtcclxuICAgICAgY29uc3Qgc3RvcmUgPSB1cGdyYWRlRGIuY3JlYXRlT2JqZWN0U3RvcmUoJ3Jlc3RhdXJhbnQtcmV2aWV3cycsIHsga2V5UGF0aDogJ2lkJyB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIHJlc3RhdXJhbnRzLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRzKGNhbGxiYWNrKSB7XHJcbiAgICBjb25zdCByZXN0YXVyYW50c0RhdGEgPSBmZXRjaChEQkhlbHBlci5EQVRBQkFTRV9VUkwoJ2FsbFJlc3RhdXJhbnRzJykpXHJcbiAgICAudGhlbihyZXNwb25zZSA9PiB7XHJcbiAgICAgIGlmICghcmVzcG9uc2Uub2spIHsgRXJyb3IocmVzcG9uc2Uuc3RhdHVzVGV4dCk7IH1cclxuICAgICAgcmV0dXJuIHJlc3BvbnNlLmpzb24oKTtcclxuICAgIH0pXHJcbiAgICAudGhlbihyZXN0YXVyYW50cyA9PiB7XHJcbiAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnRzKTtcclxuICAgICAgREJIZWxwZXIuZ2V0TG9jYWxEYXRhYmFzZSgpLnRoZW4oKGRiKSA9PiB7XHJcbiAgICAgICAgbGV0IHR4ID0gZGIudHJhbnNhY3Rpb24oJ3Jlc3RhdXJhbnQtcmV2aWV3cycsICdyZWFkd3JpdGUnKTtcclxuICAgICAgICBsZXQgcmVzdGF1cmFudHNTdG9yZSA9IHR4Lm9iamVjdFN0b3JlKCdyZXN0YXVyYW50LXJldmlld3MnKTtcclxuXHJcbiAgICAgICAgZm9yKGxldCByZXN0YXVyYW50IG9mIHJlc3RhdXJhbnRzKSB7XHJcbiAgICAgICAgICByZXN0YXVyYW50c1N0b3JlLnB1dChyZXN0YXVyYW50KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0pXHJcbiAgICB9KVxyXG4gICAgLmNhdGNoKGVycm9yID0+IHtcclxuICAgICAgLy8gVXNlIHJlc3RhdXJhbnQgSlNPTiBmcm9tIGluZGV4REIgaWYgZmV0Y2ggZmFpbHNcclxuICAgICAgREJIZWxwZXIuZ2V0TG9jYWxEYXRhYmFzZSgpLnRoZW4oKGRiKSA9PiB7XHJcbiAgICAgICAgY29uc3QgdHggPSBkYi50cmFuc2FjdGlvbigncmVzdGF1cmFudC1yZXZpZXdzJyk7XHJcbiAgICAgICAgY29uc3QgcmVzdGF1cmFudHNTdG9yZSA9IHR4Lm9iamVjdFN0b3JlKCdyZXN0YXVyYW50LXJldmlld3MnKTtcclxuXHJcbiAgICAgICAgcmV0dXJuIHJlc3RhdXJhbnRzU3RvcmUuZ2V0QWxsKCk7XHJcbiAgICAgIH0pLnRoZW4ocmVzdGF1cmFudHMgPT4ge1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnRzKTtcclxuICAgICAgfSlcclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYSByZXN0YXVyYW50IGJ5IGl0cyBJRC5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlJZChpZCwgY2FsbGJhY2spIHtcclxuICAgIC8vIGZldGNoIGFsbCByZXN0YXVyYW50cyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc3QgcmVzdGF1cmFudCA9IHJlc3RhdXJhbnRzLmZpbmQociA9PiByLmlkID09IGlkKTtcclxuICAgICAgICBpZiAocmVzdGF1cmFudCkgeyAvLyBHb3QgdGhlIHJlc3RhdXJhbnRcclxuICAgICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3RhdXJhbnQpO1xyXG4gICAgICAgIH0gZWxzZSB7IC8vIFJlc3RhdXJhbnQgZG9lcyBub3QgZXhpc3QgaW4gdGhlIGRhdGFiYXNlXHJcbiAgICAgICAgICBjYWxsYmFjaygnUmVzdGF1cmFudCBkb2VzIG5vdCBleGlzdCcsIG51bGwpO1xyXG4gICAgICAgIH1cclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgdHlwZSB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hSZXN0YXVyYW50QnlDdWlzaW5lKGN1aXNpbmUsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHMgIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEZpbHRlciByZXN0YXVyYW50cyB0byBoYXZlIG9ubHkgZ2l2ZW4gY3Vpc2luZSB0eXBlXHJcbiAgICAgICAgY29uc3QgcmVzdWx0cyA9IHJlc3RhdXJhbnRzLmZpbHRlcihyID0+IHIuY3Vpc2luZV90eXBlID09IGN1aXNpbmUpO1xyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHJlc3VsdHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIHJlc3RhdXJhbnRzIGJ5IGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeU5laWdoYm9yaG9vZChuZWlnaGJvcmhvb2QsIGNhbGxiYWNrKSB7XHJcbiAgICAvLyBGZXRjaCBhbGwgcmVzdGF1cmFudHNcclxuICAgIERCSGVscGVyLmZldGNoUmVzdGF1cmFudHMoKGVycm9yLCByZXN0YXVyYW50cykgPT4ge1xyXG4gICAgICBpZiAoZXJyb3IpIHtcclxuICAgICAgICBjYWxsYmFjayhlcnJvciwgbnVsbCk7XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgLy8gRmlsdGVyIHJlc3RhdXJhbnRzIHRvIGhhdmUgb25seSBnaXZlbiBuZWlnaGJvcmhvb2RcclxuICAgICAgICBjb25zdCByZXN1bHRzID0gcmVzdGF1cmFudHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuICAgICAgICBjYWxsYmFjayhudWxsLCByZXN1bHRzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBGZXRjaCByZXN0YXVyYW50cyBieSBhIGN1aXNpbmUgYW5kIGEgbmVpZ2hib3Job29kIHdpdGggcHJvcGVyIGVycm9yIGhhbmRsaW5nLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBmZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCBjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIGxldCByZXN1bHRzID0gcmVzdGF1cmFudHNcclxuICAgICAgICBpZiAoY3Vpc2luZSAhPSAnYWxsJykgeyAvLyBmaWx0ZXIgYnkgY3Vpc2luZVxyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5jdWlzaW5lX3R5cGUgPT0gY3Vpc2luZSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGlmIChuZWlnaGJvcmhvb2QgIT0gJ2FsbCcpIHsgLy8gZmlsdGVyIGJ5IG5laWdoYm9yaG9vZFxyXG4gICAgICAgICAgcmVzdWx0cyA9IHJlc3VsdHMuZmlsdGVyKHIgPT4gci5uZWlnaGJvcmhvb2QgPT0gbmVpZ2hib3Job29kKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdWx0cyk7XHJcbiAgICAgIH1cclxuICAgIH0pO1xyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogRmV0Y2ggYWxsIG5laWdoYm9yaG9vZHMgd2l0aCBwcm9wZXIgZXJyb3IgaGFuZGxpbmcuXHJcbiAgICovXHJcbiAgc3RhdGljIGZldGNoTmVpZ2hib3Job29kcyhjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEdldCBhbGwgbmVpZ2hib3Job29kcyBmcm9tIGFsbCByZXN0YXVyYW50c1xyXG4gICAgICAgIGNvbnN0IG5laWdoYm9yaG9vZHMgPSByZXN0YXVyYW50cy5tYXAoKHYsIGkpID0+IHJlc3RhdXJhbnRzW2ldLm5laWdoYm9yaG9vZClcclxuICAgICAgICAvLyBSZW1vdmUgZHVwbGljYXRlcyBmcm9tIG5laWdoYm9yaG9vZHNcclxuICAgICAgICBjb25zdCB1bmlxdWVOZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcy5maWx0ZXIoKHYsIGkpID0+IG5laWdoYm9yaG9vZHMuaW5kZXhPZih2KSA9PSBpKVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZU5laWdoYm9yaG9vZHMpO1xyXG4gICAgICB9XHJcbiAgICB9KTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIEZldGNoIGFsbCBjdWlzaW5lcyB3aXRoIHByb3BlciBlcnJvciBoYW5kbGluZy5cclxuICAgKi9cclxuICBzdGF0aWMgZmV0Y2hDdWlzaW5lcyhjYWxsYmFjaykge1xyXG4gICAgLy8gRmV0Y2ggYWxsIHJlc3RhdXJhbnRzXHJcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRzKChlcnJvciwgcmVzdGF1cmFudHMpID0+IHtcclxuICAgICAgaWYgKGVycm9yKSB7XHJcbiAgICAgICAgY2FsbGJhY2soZXJyb3IsIG51bGwpO1xyXG4gICAgICB9IGVsc2Uge1xyXG4gICAgICAgIC8vIEdldCBhbGwgY3Vpc2luZXMgZnJvbSBhbGwgcmVzdGF1cmFudHNcclxuICAgICAgICBjb25zdCBjdWlzaW5lcyA9IHJlc3RhdXJhbnRzLm1hcCgodiwgaSkgPT4gcmVzdGF1cmFudHNbaV0uY3Vpc2luZV90eXBlKVxyXG4gICAgICAgIC8vIFJlbW92ZSBkdXBsaWNhdGVzIGZyb20gY3Vpc2luZXNcclxuICAgICAgICBjb25zdCB1bmlxdWVDdWlzaW5lcyA9IGN1aXNpbmVzLmZpbHRlcigodiwgaSkgPT4gY3Vpc2luZXMuaW5kZXhPZih2KSA9PSBpKVxyXG4gICAgICAgIGNhbGxiYWNrKG51bGwsIHVuaXF1ZUN1aXNpbmVzKTtcclxuICAgICAgfVxyXG4gICAgfSk7XHJcbiAgfVxyXG5cclxuICAvKipcclxuICAgKiBSZXN0YXVyYW50IHBhZ2UgVVJMLlxyXG4gICAqL1xyXG4gIHN0YXRpYyB1cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpIHtcclxuICAgIHJldHVybiAoYC4vcmVzdGF1cmFudC5odG1sP2lkPSR7cmVzdGF1cmFudC5pZH1gKTtcclxuICB9XHJcblxyXG4gIC8qKlxyXG4gICAqIFJlc3RhdXJhbnQgaW1hZ2UgVVJMLlxyXG4gICAqL1xyXG4gIHN0YXRpYyBpbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgc2l6ZSkge1xyXG4gICAgaWYgKHJlc3RhdXJhbnQucGhvdG9ncmFwaCkge1xyXG4gICAgICBpZihzaXplID09PSAnc20nKSB7XHJcbiAgICAgICAgcmV0dXJuIChgL2ltZy8ke3Jlc3RhdXJhbnQucGhvdG9ncmFwaH1fNDAwLmpwZ2ApO1xyXG4gICAgICB9XHJcbiAgICAgIHJldHVybiAoYC9pbWcvJHtyZXN0YXVyYW50LnBob3RvZ3JhcGh9XzgwMC5qcGdgKTtcclxuICAgIH1cclxuICAgIGVsc2Uge1xyXG4gICAgICBpZihzaXplID09PSAnc20nKSB7XHJcbiAgICAgICAgcmV0dXJuIChgL2ltZy9kZWZhdWx0XzQwMC5qcGdgKTtcclxuICAgICAgfVxyXG4gICAgICByZXR1cm4gKGAvaW1nL2RlZmF1bHRfODAwLmpwZ2ApO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgLyoqXHJcbiAgICogTWFwIG1hcmtlciBmb3IgYSByZXN0YXVyYW50LlxyXG4gICAqL1xyXG4gIHN0YXRpYyBtYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIG1hcCkge1xyXG4gICAgY29uc3QgbWFya2VyID0gbmV3IGdvb2dsZS5tYXBzLk1hcmtlcih7XHJcbiAgICAgIHBvc2l0aW9uOiByZXN0YXVyYW50LmxhdGxuZyxcclxuICAgICAgdGl0bGU6IHJlc3RhdXJhbnQubmFtZSxcclxuICAgICAgdXJsOiBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpLFxyXG4gICAgICBtYXA6IG1hcCxcclxuICAgICAgYW5pbWF0aW9uOiBnb29nbGUubWFwcy5BbmltYXRpb24uRFJPUH1cclxuICAgICk7XHJcbiAgICByZXR1cm4gbWFya2VyO1xyXG4gIH1cclxuXHJcbn1cclxuIiwiKGZ1bmN0aW9uKCkge1xuICBmdW5jdGlvbiB0b0FycmF5KGFycikge1xuICAgIHJldHVybiBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcnIpO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KSB7XG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUsIHJlamVjdCkge1xuICAgICAgcmVxdWVzdC5vbnN1Y2Nlc3MgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVzb2x2ZShyZXF1ZXN0LnJlc3VsdCk7XG4gICAgICB9O1xuXG4gICAgICByZXF1ZXN0Lm9uZXJyb3IgPSBmdW5jdGlvbigpIHtcbiAgICAgICAgcmVqZWN0KHJlcXVlc3QuZXJyb3IpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKSB7XG4gICAgdmFyIHJlcXVlc3Q7XG4gICAgdmFyIHAgPSBuZXcgUHJvbWlzZShmdW5jdGlvbihyZXNvbHZlLCByZWplY3QpIHtcbiAgICAgIHJlcXVlc3QgPSBvYmpbbWV0aG9kXS5hcHBseShvYmosIGFyZ3MpO1xuICAgICAgcHJvbWlzaWZ5UmVxdWVzdChyZXF1ZXN0KS50aGVuKHJlc29sdmUsIHJlamVjdCk7XG4gICAgfSk7XG5cbiAgICBwLnJlcXVlc3QgPSByZXF1ZXN0O1xuICAgIHJldHVybiBwO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJvbWlzaWZ5Q3Vyc29yUmVxdWVzdENhbGwob2JqLCBtZXRob2QsIGFyZ3MpIHtcbiAgICB2YXIgcCA9IHByb21pc2lmeVJlcXVlc3RDYWxsKG9iaiwgbWV0aG9kLCBhcmdzKTtcbiAgICByZXR1cm4gcC50aGVuKGZ1bmN0aW9uKHZhbHVlKSB7XG4gICAgICBpZiAoIXZhbHVlKSByZXR1cm47XG4gICAgICByZXR1cm4gbmV3IEN1cnNvcih2YWx1ZSwgcC5yZXF1ZXN0KTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5UHJvcGVydGllcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBwcm9wZXJ0aWVzKSB7XG4gICAgcHJvcGVydGllcy5mb3JFYWNoKGZ1bmN0aW9uKHByb3ApIHtcbiAgICAgIE9iamVjdC5kZWZpbmVQcm9wZXJ0eShQcm94eUNsYXNzLnByb3RvdHlwZSwgcHJvcCwge1xuICAgICAgICBnZXQ6IGZ1bmN0aW9uKCkge1xuICAgICAgICAgIHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdO1xuICAgICAgICB9LFxuICAgICAgICBzZXQ6IGZ1bmN0aW9uKHZhbCkge1xuICAgICAgICAgIHRoaXNbdGFyZ2V0UHJvcF1bcHJvcF0gPSB2YWw7XG4gICAgICAgIH1cbiAgICAgIH0pO1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlSZXF1ZXN0TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICAgIFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIHByb3h5TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICAgIFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiB0aGlzW3RhcmdldFByb3BdW3Byb3BdLmFwcGx5KHRoaXNbdGFyZ2V0UHJvcF0sIGFyZ3VtZW50cyk7XG4gICAgICB9O1xuICAgIH0pO1xuICB9XG5cbiAgZnVuY3Rpb24gcHJveHlDdXJzb3JSZXF1ZXN0TWV0aG9kcyhQcm94eUNsYXNzLCB0YXJnZXRQcm9wLCBDb25zdHJ1Y3RvciwgcHJvcGVydGllcykge1xuICAgIHByb3BlcnRpZXMuZm9yRWFjaChmdW5jdGlvbihwcm9wKSB7XG4gICAgICBpZiAoIShwcm9wIGluIENvbnN0cnVjdG9yLnByb3RvdHlwZSkpIHJldHVybjtcbiAgICAgIFByb3h5Q2xhc3MucHJvdG90eXBlW3Byb3BdID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJldHVybiBwcm9taXNpZnlDdXJzb3JSZXF1ZXN0Q2FsbCh0aGlzW3RhcmdldFByb3BdLCBwcm9wLCBhcmd1bWVudHMpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIGZ1bmN0aW9uIEluZGV4KGluZGV4KSB7XG4gICAgdGhpcy5faW5kZXggPSBpbmRleDtcbiAgfVxuXG4gIHByb3h5UHJvcGVydGllcyhJbmRleCwgJ19pbmRleCcsIFtcbiAgICAnbmFtZScsXG4gICAgJ2tleVBhdGgnLFxuICAgICdtdWx0aUVudHJ5JyxcbiAgICAndW5pcXVlJ1xuICBdKTtcblxuICBwcm94eVJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcbiAgICAnZ2V0JyxcbiAgICAnZ2V0S2V5JyxcbiAgICAnZ2V0QWxsJyxcbiAgICAnZ2V0QWxsS2V5cycsXG4gICAgJ2NvdW50J1xuICBdKTtcblxuICBwcm94eUN1cnNvclJlcXVlc3RNZXRob2RzKEluZGV4LCAnX2luZGV4JywgSURCSW5kZXgsIFtcbiAgICAnb3BlbkN1cnNvcicsXG4gICAgJ29wZW5LZXlDdXJzb3InXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIEN1cnNvcihjdXJzb3IsIHJlcXVlc3QpIHtcbiAgICB0aGlzLl9jdXJzb3IgPSBjdXJzb3I7XG4gICAgdGhpcy5fcmVxdWVzdCA9IHJlcXVlc3Q7XG4gIH1cblxuICBwcm94eVByb3BlcnRpZXMoQ3Vyc29yLCAnX2N1cnNvcicsIFtcbiAgICAnZGlyZWN0aW9uJyxcbiAgICAna2V5JyxcbiAgICAncHJpbWFyeUtleScsXG4gICAgJ3ZhbHVlJ1xuICBdKTtcblxuICBwcm94eVJlcXVlc3RNZXRob2RzKEN1cnNvciwgJ19jdXJzb3InLCBJREJDdXJzb3IsIFtcbiAgICAndXBkYXRlJyxcbiAgICAnZGVsZXRlJ1xuICBdKTtcblxuICAvLyBwcm94eSAnbmV4dCcgbWV0aG9kc1xuICBbJ2FkdmFuY2UnLCAnY29udGludWUnLCAnY29udGludWVQcmltYXJ5S2V5J10uZm9yRWFjaChmdW5jdGlvbihtZXRob2ROYW1lKSB7XG4gICAgaWYgKCEobWV0aG9kTmFtZSBpbiBJREJDdXJzb3IucHJvdG90eXBlKSkgcmV0dXJuO1xuICAgIEN1cnNvci5wcm90b3R5cGVbbWV0aG9kTmFtZV0gPSBmdW5jdGlvbigpIHtcbiAgICAgIHZhciBjdXJzb3IgPSB0aGlzO1xuICAgICAgdmFyIGFyZ3MgPSBhcmd1bWVudHM7XG4gICAgICByZXR1cm4gUHJvbWlzZS5yZXNvbHZlKCkudGhlbihmdW5jdGlvbigpIHtcbiAgICAgICAgY3Vyc29yLl9jdXJzb3JbbWV0aG9kTmFtZV0uYXBwbHkoY3Vyc29yLl9jdXJzb3IsIGFyZ3MpO1xuICAgICAgICByZXR1cm4gcHJvbWlzaWZ5UmVxdWVzdChjdXJzb3IuX3JlcXVlc3QpLnRoZW4oZnVuY3Rpb24odmFsdWUpIHtcbiAgICAgICAgICBpZiAoIXZhbHVlKSByZXR1cm47XG4gICAgICAgICAgcmV0dXJuIG5ldyBDdXJzb3IodmFsdWUsIGN1cnNvci5fcmVxdWVzdCk7XG4gICAgICAgIH0pO1xuICAgICAgfSk7XG4gICAgfTtcbiAgfSk7XG5cbiAgZnVuY3Rpb24gT2JqZWN0U3RvcmUoc3RvcmUpIHtcbiAgICB0aGlzLl9zdG9yZSA9IHN0b3JlO1xuICB9XG5cbiAgT2JqZWN0U3RvcmUucHJvdG90eXBlLmNyZWF0ZUluZGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBJbmRleCh0aGlzLl9zdG9yZS5jcmVhdGVJbmRleC5hcHBseSh0aGlzLl9zdG9yZSwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgT2JqZWN0U3RvcmUucHJvdG90eXBlLmluZGV4ID0gZnVuY3Rpb24oKSB7XG4gICAgcmV0dXJuIG5ldyBJbmRleCh0aGlzLl9zdG9yZS5pbmRleC5hcHBseSh0aGlzLl9zdG9yZSwgYXJndW1lbnRzKSk7XG4gIH07XG5cbiAgcHJveHlQcm9wZXJ0aWVzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgW1xuICAgICduYW1lJyxcbiAgICAna2V5UGF0aCcsXG4gICAgJ2luZGV4TmFtZXMnLFxuICAgICdhdXRvSW5jcmVtZW50J1xuICBdKTtcblxuICBwcm94eVJlcXVlc3RNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcbiAgICAncHV0JyxcbiAgICAnYWRkJyxcbiAgICAnZGVsZXRlJyxcbiAgICAnY2xlYXInLFxuICAgICdnZXQnLFxuICAgICdnZXRBbGwnLFxuICAgICdnZXRLZXknLFxuICAgICdnZXRBbGxLZXlzJyxcbiAgICAnY291bnQnXG4gIF0pO1xuXG4gIHByb3h5Q3Vyc29yUmVxdWVzdE1ldGhvZHMoT2JqZWN0U3RvcmUsICdfc3RvcmUnLCBJREJPYmplY3RTdG9yZSwgW1xuICAgICdvcGVuQ3Vyc29yJyxcbiAgICAnb3BlbktleUN1cnNvcidcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKE9iamVjdFN0b3JlLCAnX3N0b3JlJywgSURCT2JqZWN0U3RvcmUsIFtcbiAgICAnZGVsZXRlSW5kZXgnXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIFRyYW5zYWN0aW9uKGlkYlRyYW5zYWN0aW9uKSB7XG4gICAgdGhpcy5fdHggPSBpZGJUcmFuc2FjdGlvbjtcbiAgICB0aGlzLmNvbXBsZXRlID0gbmV3IFByb21pc2UoZnVuY3Rpb24ocmVzb2x2ZSwgcmVqZWN0KSB7XG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmNvbXBsZXRlID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlc29sdmUoKTtcbiAgICAgIH07XG4gICAgICBpZGJUcmFuc2FjdGlvbi5vbmVycm9yID0gZnVuY3Rpb24oKSB7XG4gICAgICAgIHJlamVjdChpZGJUcmFuc2FjdGlvbi5lcnJvcik7XG4gICAgICB9O1xuICAgICAgaWRiVHJhbnNhY3Rpb24ub25hYm9ydCA9IGZ1bmN0aW9uKCkge1xuICAgICAgICByZWplY3QoaWRiVHJhbnNhY3Rpb24uZXJyb3IpO1xuICAgICAgfTtcbiAgICB9KTtcbiAgfVxuXG4gIFRyYW5zYWN0aW9uLnByb3RvdHlwZS5vYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgT2JqZWN0U3RvcmUodGhpcy5fdHgub2JqZWN0U3RvcmUuYXBwbHkodGhpcy5fdHgsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhUcmFuc2FjdGlvbiwgJ190eCcsIFtcbiAgICAnb2JqZWN0U3RvcmVOYW1lcycsXG4gICAgJ21vZGUnXG4gIF0pO1xuXG4gIHByb3h5TWV0aG9kcyhUcmFuc2FjdGlvbiwgJ190eCcsIElEQlRyYW5zYWN0aW9uLCBbXG4gICAgJ2Fib3J0J1xuICBdKTtcblxuICBmdW5jdGlvbiBVcGdyYWRlREIoZGIsIG9sZFZlcnNpb24sIHRyYW5zYWN0aW9uKSB7XG4gICAgdGhpcy5fZGIgPSBkYjtcbiAgICB0aGlzLm9sZFZlcnNpb24gPSBvbGRWZXJzaW9uO1xuICAgIHRoaXMudHJhbnNhY3Rpb24gPSBuZXcgVHJhbnNhY3Rpb24odHJhbnNhY3Rpb24pO1xuICB9XG5cbiAgVXBncmFkZURCLnByb3RvdHlwZS5jcmVhdGVPYmplY3RTdG9yZSA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgT2JqZWN0U3RvcmUodGhpcy5fZGIuY3JlYXRlT2JqZWN0U3RvcmUuYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhVcGdyYWRlREIsICdfZGInLCBbXG4gICAgJ25hbWUnLFxuICAgICd2ZXJzaW9uJyxcbiAgICAnb2JqZWN0U3RvcmVOYW1lcydcbiAgXSk7XG5cbiAgcHJveHlNZXRob2RzKFVwZ3JhZGVEQiwgJ19kYicsIElEQkRhdGFiYXNlLCBbXG4gICAgJ2RlbGV0ZU9iamVjdFN0b3JlJyxcbiAgICAnY2xvc2UnXG4gIF0pO1xuXG4gIGZ1bmN0aW9uIERCKGRiKSB7XG4gICAgdGhpcy5fZGIgPSBkYjtcbiAgfVxuXG4gIERCLnByb3RvdHlwZS50cmFuc2FjdGlvbiA9IGZ1bmN0aW9uKCkge1xuICAgIHJldHVybiBuZXcgVHJhbnNhY3Rpb24odGhpcy5fZGIudHJhbnNhY3Rpb24uYXBwbHkodGhpcy5fZGIsIGFyZ3VtZW50cykpO1xuICB9O1xuXG4gIHByb3h5UHJvcGVydGllcyhEQiwgJ19kYicsIFtcbiAgICAnbmFtZScsXG4gICAgJ3ZlcnNpb24nLFxuICAgICdvYmplY3RTdG9yZU5hbWVzJ1xuICBdKTtcblxuICBwcm94eU1ldGhvZHMoREIsICdfZGInLCBJREJEYXRhYmFzZSwgW1xuICAgICdjbG9zZSdcbiAgXSk7XG5cbiAgLy8gQWRkIGN1cnNvciBpdGVyYXRvcnNcbiAgLy8gVE9ETzogcmVtb3ZlIHRoaXMgb25jZSBicm93c2VycyBkbyB0aGUgcmlnaHQgdGhpbmcgd2l0aCBwcm9taXNlc1xuICBbJ29wZW5DdXJzb3InLCAnb3BlbktleUN1cnNvciddLmZvckVhY2goZnVuY3Rpb24oZnVuY05hbWUpIHtcbiAgICBbT2JqZWN0U3RvcmUsIEluZGV4XS5mb3JFYWNoKGZ1bmN0aW9uKENvbnN0cnVjdG9yKSB7XG4gICAgICAvLyBEb24ndCBjcmVhdGUgaXRlcmF0ZUtleUN1cnNvciBpZiBvcGVuS2V5Q3Vyc29yIGRvZXNuJ3QgZXhpc3QuXG4gICAgICBpZiAoIShmdW5jTmFtZSBpbiBDb25zdHJ1Y3Rvci5wcm90b3R5cGUpKSByZXR1cm47XG5cbiAgICAgIENvbnN0cnVjdG9yLnByb3RvdHlwZVtmdW5jTmFtZS5yZXBsYWNlKCdvcGVuJywgJ2l0ZXJhdGUnKV0gPSBmdW5jdGlvbigpIHtcbiAgICAgICAgdmFyIGFyZ3MgPSB0b0FycmF5KGFyZ3VtZW50cyk7XG4gICAgICAgIHZhciBjYWxsYmFjayA9IGFyZ3NbYXJncy5sZW5ndGggLSAxXTtcbiAgICAgICAgdmFyIG5hdGl2ZU9iamVjdCA9IHRoaXMuX3N0b3JlIHx8IHRoaXMuX2luZGV4O1xuICAgICAgICB2YXIgcmVxdWVzdCA9IG5hdGl2ZU9iamVjdFtmdW5jTmFtZV0uYXBwbHkobmF0aXZlT2JqZWN0LCBhcmdzLnNsaWNlKDAsIC0xKSk7XG4gICAgICAgIHJlcXVlc3Qub25zdWNjZXNzID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgY2FsbGJhY2socmVxdWVzdC5yZXN1bHQpO1xuICAgICAgICB9O1xuICAgICAgfTtcbiAgICB9KTtcbiAgfSk7XG5cbiAgLy8gcG9seWZpbGwgZ2V0QWxsXG4gIFtJbmRleCwgT2JqZWN0U3RvcmVdLmZvckVhY2goZnVuY3Rpb24oQ29uc3RydWN0b3IpIHtcbiAgICBpZiAoQ29uc3RydWN0b3IucHJvdG90eXBlLmdldEFsbCkgcmV0dXJuO1xuICAgIENvbnN0cnVjdG9yLnByb3RvdHlwZS5nZXRBbGwgPSBmdW5jdGlvbihxdWVyeSwgY291bnQpIHtcbiAgICAgIHZhciBpbnN0YW5jZSA9IHRoaXM7XG4gICAgICB2YXIgaXRlbXMgPSBbXTtcblxuICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uKHJlc29sdmUpIHtcbiAgICAgICAgaW5zdGFuY2UuaXRlcmF0ZUN1cnNvcihxdWVyeSwgZnVuY3Rpb24oY3Vyc29yKSB7XG4gICAgICAgICAgaWYgKCFjdXJzb3IpIHtcbiAgICAgICAgICAgIHJlc29sdmUoaXRlbXMpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBpdGVtcy5wdXNoKGN1cnNvci52YWx1ZSk7XG5cbiAgICAgICAgICBpZiAoY291bnQgIT09IHVuZGVmaW5lZCAmJiBpdGVtcy5sZW5ndGggPT0gY291bnQpIHtcbiAgICAgICAgICAgIHJlc29sdmUoaXRlbXMpO1xuICAgICAgICAgICAgcmV0dXJuO1xuICAgICAgICAgIH1cbiAgICAgICAgICBjdXJzb3IuY29udGludWUoKTtcbiAgICAgICAgfSk7XG4gICAgICB9KTtcbiAgICB9O1xuICB9KTtcblxuICB2YXIgZXhwID0ge1xuICAgIG9wZW46IGZ1bmN0aW9uKG5hbWUsIHZlcnNpb24sIHVwZ3JhZGVDYWxsYmFjaykge1xuICAgICAgdmFyIHAgPSBwcm9taXNpZnlSZXF1ZXN0Q2FsbChpbmRleGVkREIsICdvcGVuJywgW25hbWUsIHZlcnNpb25dKTtcbiAgICAgIHZhciByZXF1ZXN0ID0gcC5yZXF1ZXN0O1xuXG4gICAgICBpZiAocmVxdWVzdCkge1xuICAgICAgICByZXF1ZXN0Lm9udXBncmFkZW5lZWRlZCA9IGZ1bmN0aW9uKGV2ZW50KSB7XG4gICAgICAgICAgaWYgKHVwZ3JhZGVDYWxsYmFjaykge1xuICAgICAgICAgICAgdXBncmFkZUNhbGxiYWNrKG5ldyBVcGdyYWRlREIocmVxdWVzdC5yZXN1bHQsIGV2ZW50Lm9sZFZlcnNpb24sIHJlcXVlc3QudHJhbnNhY3Rpb24pKTtcbiAgICAgICAgICB9XG4gICAgICAgIH07XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBwLnRoZW4oZnVuY3Rpb24oZGIpIHtcbiAgICAgICAgcmV0dXJuIG5ldyBEQihkYik7XG4gICAgICB9KTtcbiAgICB9LFxuICAgIGRlbGV0ZTogZnVuY3Rpb24obmFtZSkge1xuICAgICAgcmV0dXJuIHByb21pc2lmeVJlcXVlc3RDYWxsKGluZGV4ZWREQiwgJ2RlbGV0ZURhdGFiYXNlJywgW25hbWVdKTtcbiAgICB9XG4gIH07XG5cbiAgaWYgKHR5cGVvZiBtb2R1bGUgIT09ICd1bmRlZmluZWQnKSB7XG4gICAgbW9kdWxlLmV4cG9ydHMgPSBleHA7XG4gICAgbW9kdWxlLmV4cG9ydHMuZGVmYXVsdCA9IG1vZHVsZS5leHBvcnRzO1xuICB9XG4gIGVsc2Uge1xuICAgIHNlbGYuaWRiID0gZXhwO1xuICB9XG59KCkpOyIsImxldCByZXN0YXVyYW50cztcclxubGV0IG5laWdoYm9yaG9vZHM7XHJcbmxldCBjdWlzaW5lcztcclxubGV0IG1hcDtcclxubGV0IG1hcmtlcnMgPSBbXTtcclxubGV0IGhvbWUgPSB3aW5kb3cubG9jYXRpb24ucGF0aG5hbWUgPT09ICcvJztcclxuXHJcbmNvbnNvbGUubG9nKCdoZXJlJylcclxuXHJcbi8qKlxyXG4gKiBGZXRjaCBuZWlnaGJvcmhvb2RzIGFuZCBjdWlzaW5lcyBhcyBzb29uIGFzIHRoZSBwYWdlIGlzIGxvYWRlZC5cclxuICovXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCAoZXZlbnQpID0+IHtcclxuICBmZXRjaE5laWdoYm9yaG9vZHMoKTtcclxuICBmZXRjaEN1aXNpbmVzKCk7XHJcbiAgcmVnaXN0ZXJTZXJ2aWNlV29ya2VyKCk7XHJcbn0pO1xyXG5cclxuLyoqXHJcbiAqIEFkZCB0aXRsZSB0byBtYXBzIGlmcmFtZS5cclxuICovXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgKCkgPT4ge1xyXG4gIGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJ2lmcmFtZScpWzBdLnRpdGxlID0gJ1Jlc3RhdXJhbnQgbWFwJztcclxufSk7XHJcblxyXG4vKipcclxuICogUmVnaXN0ZXIgU2VydmljZSBXb3JrZXIuXHJcbiAqL1xyXG5yZWdpc3RlclNlcnZpY2VXb3JrZXIgPSAoKSA9PiB7XHJcbiAgaWYgKCFuYXZpZ2F0b3Iuc2VydmljZVdvcmtlcikgcmV0dXJuO1xyXG5cclxuICBuYXZpZ2F0b3Iuc2VydmljZVdvcmtlci5yZWdpc3RlcignL3N3LmpzJykudGhlbigoKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZygnU2VydmljZSB3b3JrZWQgcmVnaXN0ZXJlZCEnKTtcclxuICB9KS5jYXRjaCgoZXJyKSA9PiB7XHJcbiAgICBjb25zb2xlLmxvZygnUmVnaXN0cmF0aW9uIGZhaWxlZCEnKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEZldGNoIGFsbCBuZWlnaGJvcmhvb2RzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoTmVpZ2hib3Job29kcyA9ICgpID0+IHtcclxuICBEQkhlbHBlci5mZXRjaE5laWdoYm9yaG9vZHMoKGVycm9yLCBuZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yXHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgfSBlbHNlIHtcclxuICAgICAgc2VsZi5uZWlnaGJvcmhvb2RzID0gbmVpZ2hib3Job29kcztcclxuICAgICAgZmlsbE5laWdoYm9yaG9vZHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBTZXQgbmVpZ2hib3Job29kcyBIVE1MLlxyXG4gKi9cclxuXHJcbmZpbGxOZWlnaGJvcmhvb2RzSFRNTCA9IChuZWlnaGJvcmhvb2RzID0gc2VsZi5uZWlnaGJvcmhvb2RzKSA9PiB7XHJcbiAgY29uc3Qgc2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcbiAgbmVpZ2hib3Job29kcy5mb3JFYWNoKG5laWdoYm9yaG9vZCA9PiB7XHJcbiAgICBjb25zdCBvcHRpb24gPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdvcHRpb24nKTtcclxuICAgIG9wdGlvbi5pbm5lckhUTUwgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBvcHRpb24udmFsdWUgPSBuZWlnaGJvcmhvb2Q7XHJcbiAgICBpZiAoaG9tZSkgc2VsZWN0LmFwcGVuZChvcHRpb24pO1xyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogRmV0Y2ggYWxsIGN1aXNpbmVzIGFuZCBzZXQgdGhlaXIgSFRNTC5cclxuICovXHJcbmZldGNoQ3Vpc2luZXMgPSAoKSA9PiB7XHJcbiAgREJIZWxwZXIuZmV0Y2hDdWlzaW5lcygoZXJyb3IsIGN1aXNpbmVzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHNlbGYuY3Vpc2luZXMgPSBjdWlzaW5lcztcclxuICAgICAgZmlsbEN1aXNpbmVzSFRNTCgpO1xyXG4gICAgfVxyXG4gIH0pO1xyXG59XHJcblxyXG4vKipcclxuICogU2V0IGN1aXNpbmVzIEhUTUwuXHJcbiAqL1xyXG5maWxsQ3Vpc2luZXNIVE1MID0gKGN1aXNpbmVzID0gc2VsZi5jdWlzaW5lcykgPT4ge1xyXG4gIGNvbnN0IHNlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuXHJcbiAgY3Vpc2luZXMuZm9yRWFjaChjdWlzaW5lID0+IHtcclxuICAgIGNvbnN0IG9wdGlvbiA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ29wdGlvbicpO1xyXG4gICAgb3B0aW9uLmlubmVySFRNTCA9IGN1aXNpbmU7XHJcbiAgICBvcHRpb24udmFsdWUgPSBjdWlzaW5lO1xyXG4gICAgaWYgKGhvbWUpIHNlbGVjdC5hcHBlbmQob3B0aW9uKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cclxuICovXHJcbndpbmRvdy5pbml0TWFwID0gKCkgPT4ge1xyXG4gIGxldCBsb2MgPSB7XHJcbiAgICBsYXQ6IDQwLjcyMjIxNixcclxuICAgIGxuZzogLTczLjk4NzUwMVxyXG4gIH07XHJcbiAgc2VsZi5tYXAgPSBuZXcgZ29vZ2xlLm1hcHMuTWFwKGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tYXAnKSwge1xyXG4gICAgem9vbTogMTIsXHJcbiAgICBjZW50ZXI6IGxvYyxcclxuICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxyXG4gIH0pO1xyXG4gIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBVcGRhdGUgcGFnZSBhbmQgbWFwIGZvciBjdXJyZW50IHJlc3RhdXJhbnRzLlxyXG4gKi9cclxudXBkYXRlUmVzdGF1cmFudHMgPSAoKSA9PiB7XHJcbiAgY29uc3QgY1NlbGVjdCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdjdWlzaW5lcy1zZWxlY3QnKTtcclxuICBjb25zdCBuU2VsZWN0ID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0Jyk7XHJcblxyXG4gIGNvbnN0IGNJbmRleCA9IGNTZWxlY3Quc2VsZWN0ZWRJbmRleDtcclxuICBjb25zdCBuSW5kZXggPSBuU2VsZWN0LnNlbGVjdGVkSW5kZXg7XHJcblxyXG4gIGNvbnN0IGN1aXNpbmUgPSBjU2VsZWN0W2NJbmRleF0udmFsdWU7XHJcbiAgY29uc3QgbmVpZ2hib3Job29kID0gblNlbGVjdFtuSW5kZXhdLnZhbHVlO1xyXG5cclxuICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUN1aXNpbmVBbmROZWlnaGJvcmhvb2QoY3Vpc2luZSwgbmVpZ2hib3Job29kLCAoZXJyb3IsIHJlc3RhdXJhbnRzKSA9PiB7XHJcbiAgICBpZiAoZXJyb3IpIHsgLy8gR290IGFuIGVycm9yIVxyXG4gICAgICBjb25zb2xlLmVycm9yKGVycm9yKTtcclxuICAgIH0gZWxzZSB7XHJcbiAgICAgIHJlc2V0UmVzdGF1cmFudHMocmVzdGF1cmFudHMpO1xyXG4gICAgICBmaWxsUmVzdGF1cmFudHNIVE1MKCk7XHJcbiAgICB9XHJcbiAgfSlcclxufVxyXG5cclxuLyoqXHJcbiAqIEFkZCBldmVudCBsaXN0ZW5lcnMgZm9yIGZpbHRlciBkcm9wZG93bnMuXHJcbiAqL1xyXG5pZiAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ25laWdoYm9yaG9vZHMtc2VsZWN0JykpIHtcclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnbmVpZ2hib3Job29kcy1zZWxlY3QnKS5hZGRFdmVudExpc3RlbmVyKCdjaGFuZ2UnLCAoKSA9PiB7XHJcbiAgICAgIHVwZGF0ZVJlc3RhdXJhbnRzKCk7XHJcbiAgfSk7XHJcbn1cclxuXHJcbmlmIChkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0JykpIHtcclxuICBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnY3Vpc2luZXMtc2VsZWN0JykuYWRkRXZlbnRMaXN0ZW5lcignY2hhbmdlJywgKCkgPT4ge1xyXG4gICAgdXBkYXRlUmVzdGF1cmFudHMoKTtcclxuICB9KTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENsZWFyIGN1cnJlbnQgcmVzdGF1cmFudHMsIHRoZWlyIEhUTUwgYW5kIHJlbW92ZSB0aGVpciBtYXAgbWFya2Vycy5cclxuICovXHJcbnJlc2V0UmVzdGF1cmFudHMgPSAocmVzdGF1cmFudHMpID0+IHtcclxuICAvLyBSZW1vdmUgYWxsIHJlc3RhdXJhbnRzXHJcbiAgc2VsZi5yZXN0YXVyYW50cyA9IFtdO1xyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJlc3RhdXJhbnRzLWxpc3QnKTtcclxuICB1bC5pbm5lckhUTUwgPSAnJztcclxuXHJcbiAgLy8gUmVtb3ZlIGFsbCBtYXAgbWFya2Vyc1xyXG4gIHNlbGYubWFya2Vycy5mb3JFYWNoKG0gPT4gbS5zZXRNYXAobnVsbCkpO1xyXG4gIHNlbGYubWFya2VycyA9IFtdO1xyXG4gIHNlbGYucmVzdGF1cmFudHMgPSByZXN0YXVyYW50cztcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSBhbGwgcmVzdGF1cmFudHMgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXHJcbiAqL1xyXG5maWxsUmVzdGF1cmFudHNIVE1MID0gKHJlc3RhdXJhbnRzID0gc2VsZi5yZXN0YXVyYW50cykgPT4ge1xyXG4gIGNvbnN0IHVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJlc3RhdXJhbnRzLWxpc3QnKTtcclxuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgdWwuYXBwZW5kKGNyZWF0ZVJlc3RhdXJhbnRIVE1MKHJlc3RhdXJhbnQpKTtcclxuICB9KTtcclxuICBhZGRNYXJrZXJzVG9NYXAoKTtcclxufVxyXG5cclxuLyoqXHJcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwuLi5cclxuICovXHJcbmNyZWF0ZVJlc3RhdXJhbnRIVE1MID0gKHJlc3RhdXJhbnQpID0+IHtcclxuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XHJcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XHJcbiAgY29uc3QgcGljdHVyZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3BpY3R1cmUnKTtcclxuICBjb25zdCBzb3VyY2VMZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xyXG4gIGNvbnN0IHNvdXJjZVNtID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnc291cmNlJyk7XHJcbiAgY29uc3QgaW1hZ2UgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdpbWcnKTtcclxuXHJcbiAgc291cmNlTGcuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcclxuICBzb3VyY2VMZy5hbHQgPSByZXN0YXVyYW50Lm5hbWU7XHJcbiAgc291cmNlTGcubWVkaWEgPSBcIihtaW4td2lkdGg6IDUwMHB4KVwiO1xyXG4gIHNvdXJjZUxnLnNyY3NldCA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCAnbGcnKTtcclxuICBwaWN0dXJlLmFwcGVuZChzb3VyY2VMZyk7XHJcblxyXG4gIHNvdXJjZVNtLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XHJcbiAgc291cmNlU20uYWx0ID0gcmVzdGF1cmFudC5uYW1lO1xyXG4gIHNvdXJjZVNtLm1lZGlhID0gXCIobWF4LXdpZHRoOiA1MDBweClcIjtcclxuICBzb3VyY2VTbS5zcmNzZXQgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgJ3NtJyk7XHJcbiAgcGljdHVyZS5hcHBlbmQoc291cmNlU20pO1xyXG5cclxuICBpbWFnZS5jbGFzc05hbWUgPSAncmVzdGF1cmFudC1pbWcnO1xyXG4gIGltYWdlLmFsdCA9IHJlc3RhdXJhbnQubmFtZTtcclxuICBpbWFnZS5zcmMgPSBEQkhlbHBlci5pbWFnZVVybEZvclJlc3RhdXJhbnQocmVzdGF1cmFudCwgJ2xnJyk7XHJcbiAgcGljdHVyZS5hcHBlbmQoaW1hZ2UpO1xyXG5cclxuICBsaS5hcHBlbmQocGljdHVyZSk7XHJcblxyXG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdoMicpO1xyXG4gIG5hbWUuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xyXG4gIGNvbnRhaW5lci5hcHBlbmQobmFtZSk7XHJcblxyXG4gIGNvbnN0IG5laWdoYm9yaG9vZCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcclxuICBuZWlnaGJvcmhvb2QuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uZWlnaGJvcmhvb2Q7XHJcbiAgbmVpZ2hib3Job29kLmNsYXNzTGlzdCArPSAnbmVpZ2hib3Job29kJztcclxuICBjb250YWluZXIuYXBwZW5kKG5laWdoYm9yaG9vZCk7XHJcblxyXG4gIGNvbnN0IGFkZHJlc3MgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XHJcbiAgYWRkcmVzcy5pbm5lckhUTUwgPSByZXN0YXVyYW50LmFkZHJlc3M7XHJcbiAgY29udGFpbmVyLmFwcGVuZChhZGRyZXNzKTtcclxuXHJcbiAgY29uc3QgbW9yZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2EnKTtcclxuICBtb3JlLmlubmVySFRNTCA9ICdWaWV3IERldGFpbHMnO1xyXG4gIG1vcmUuc2V0QXR0cmlidXRlKCdhcmlhLWxhYmVsJywgcmVzdGF1cmFudC5uYW1lKTtcclxuICBtb3JlLmhyZWYgPSBEQkhlbHBlci51cmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQpO1xyXG4gIGNvbnRhaW5lci5hcHBlbmQobW9yZSlcclxuXHJcbiAgbGkuYXBwZW5kKGNvbnRhaW5lcilcclxuXHJcbiAgcmV0dXJuIGxpO1xyXG59XHJcblxyXG4vKipcclxuICogQWRkIG1hcmtlcnMgZm9yIGN1cnJlbnQgcmVzdGF1cmFudHMgdG8gdGhlIG1hcC5cclxuICovXHJcbmFkZE1hcmtlcnNUb01hcCA9IChyZXN0YXVyYW50cyA9IHNlbGYucmVzdGF1cmFudHMpID0+IHtcclxuICByZXN0YXVyYW50cy5mb3JFYWNoKHJlc3RhdXJhbnQgPT4ge1xyXG4gICAgLy8gQWRkIG1hcmtlciB0byB0aGUgbWFwXHJcbiAgICBjb25zdCBtYXJrZXIgPSBEQkhlbHBlci5tYXBNYXJrZXJGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsIHNlbGYubWFwKTtcclxuICAgIGdvb2dsZS5tYXBzLmV2ZW50LmFkZExpc3RlbmVyKG1hcmtlciwgJ2NsaWNrJywgKCkgPT4ge1xyXG4gICAgICB3aW5kb3cubG9jYXRpb24uaHJlZiA9IG1hcmtlci51cmxcclxuICAgIH0pO1xyXG4gICAgc2VsZi5tYXJrZXJzLnB1c2gobWFya2VyKTtcclxuICB9KTtcclxufVxyXG4iLCJsZXQgcmVzdGF1cmFudDtcbmxldCBtYXBJbmZvO1xuXG4vKipcbiAqIEluaXRpYWxpemUgR29vZ2xlIG1hcCwgY2FsbGVkIGZyb20gSFRNTC5cbiAqL1xuaWYod2luZG93LmxvY2F0aW9uLnBhdGhuYW1lID09PSAnL3Jlc3RhdXJhbnQuaHRtbCcpIHtcbiAgd2luZG93LmluaXRNYXAgPSAoKSA9PiB7XG4gICAgZmV0Y2hSZXN0YXVyYW50RnJvbVVSTCgoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcbiAgICAgIGlmIChlcnJvcikgeyAvLyBHb3QgYW4gZXJyb3IhXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgc2VsZi5tYXBJbmZvID0gbmV3IGdvb2dsZS5tYXBzLk1hcChkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubWFwJyksIHtcbiAgICAgICAgICB6b29tOiAxNixcbiAgICAgICAgICBjZW50ZXI6IHJlc3RhdXJhbnQubGF0bG5nLFxuICAgICAgICAgIHNjcm9sbHdoZWVsOiBmYWxzZVxuICAgICAgICB9KTtcbiAgICAgICAgZmlsbEJyZWFkY3J1bWIoKTtcbiAgICAgICAgREJIZWxwZXIubWFwTWFya2VyRm9yUmVzdGF1cmFudChzZWxmLnJlc3RhdXJhbnQsIHNlbGYubWFwSW5mbyk7XG4gICAgICB9XG4gICAgfSk7XG4gIH1cbn1cblxuLyoqXG4gKiBHZXQgY3VycmVudCByZXN0YXVyYW50IGZyb20gcGFnZSBVUkwuXG4gKi9cbmZldGNoUmVzdGF1cmFudEZyb21VUkwgPSAoY2FsbGJhY2spID0+IHtcbiAgaWYgKHNlbGYucmVzdGF1cmFudCkgeyAvLyByZXN0YXVyYW50IGFscmVhZHkgZmV0Y2hlZCFcbiAgICBjYWxsYmFjayhudWxsLCBzZWxmLnJlc3RhdXJhbnQpXG4gICAgcmV0dXJuO1xuICB9XG4gIGNvbnN0IGlkID0gZ2V0UGFyYW1ldGVyQnlOYW1lKCdpZCcpO1xuICBpZiAoIWlkKSB7IC8vIG5vIGlkIGZvdW5kIGluIFVSTFxuICAgIGVycm9yID0gJ05vIHJlc3RhdXJhbnQgaWQgaW4gVVJMJ1xuICAgIGNhbGxiYWNrKGVycm9yLCBudWxsKTtcbiAgfSBlbHNlIHtcbiAgICBEQkhlbHBlci5mZXRjaFJlc3RhdXJhbnRCeUlkKGlkLCAoZXJyb3IsIHJlc3RhdXJhbnQpID0+IHtcbiAgICAgIHNlbGYucmVzdGF1cmFudCA9IHJlc3RhdXJhbnQ7XG4gICAgICBpZiAoIXJlc3RhdXJhbnQpIHtcbiAgICAgICAgY29uc29sZS5lcnJvcihlcnJvcik7XG4gICAgICAgIHJldHVybjtcbiAgICAgIH1cbiAgICAgIGZpbGxSZXN0YXVyYW50SFRNTCgpO1xuICAgICAgY2FsbGJhY2sobnVsbCwgcmVzdGF1cmFudClcbiAgICB9KTtcbiAgfVxufVxuXG4vKipcbiAqIENyZWF0ZSByZXN0YXVyYW50IEhUTUwgYW5kIGFkZCBpdCB0byB0aGUgd2VicGFnZVxuICovXG5maWxsUmVzdGF1cmFudEhUTUwgPSAocmVzdGF1cmFudCA9IHNlbGYucmVzdGF1cmFudCkgPT4ge1xuICBjb25zdCBuYW1lID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJlc3RhdXJhbnQtbmFtZScpO1xuICBuYW1lLmlubmVySFRNTCA9IHJlc3RhdXJhbnQubmFtZTtcblxuICBjb25zdCBhZGRyZXNzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJlc3RhdXJhbnQtYWRkcmVzcycpO1xuICBhZGRyZXNzLmlubmVySFRNTCA9IHJlc3RhdXJhbnQuYWRkcmVzcztcblxuICBjb25zdCBzb3VyY2VMZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xuICBjb25zdCBzb3VyY2VTbSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3NvdXJjZScpO1xuICBjb25zdCBkZWZhdWx0SW1nID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnaW1nJyk7XG4gIGNvbnN0IGltYWdlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJlc3RhdXJhbnQtaW1nJyk7XG5cbiAgc291cmNlTGcuY2xhc3NOYW1lID0gJ3Jlc3RhdXJhbnQtaW1nJztcbiAgc291cmNlTGcuYWx0ID0gcmVzdGF1cmFudC5hbHQ7XG4gIHNvdXJjZUxnLm1lZGlhID0gXCIobWluLXdpZHRoOiA1MDBweClcIjtcbiAgc291cmNlTGcuc3Jjc2V0ID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsICdsZycpO1xuICBpbWFnZS5hcHBlbmQoc291cmNlTGcpO1xuXG4gIHNvdXJjZVNtLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XG4gIHNvdXJjZVNtLmFsdCA9IHJlc3RhdXJhbnQuYWx0O1xuICBzb3VyY2VTbS5tZWRpYSA9IFwiKG1heC13aWR0aDogNTAwcHgpXCI7XG4gIHNvdXJjZVNtLnNyY3NldCA9IERCSGVscGVyLmltYWdlVXJsRm9yUmVzdGF1cmFudChyZXN0YXVyYW50LCAnc20nKTtcbiAgaW1hZ2UuYXBwZW5kKHNvdXJjZVNtKTtcblxuICBkZWZhdWx0SW1nLmNsYXNzTmFtZSA9ICdyZXN0YXVyYW50LWltZyc7XG4gIGRlZmF1bHRJbWcuYWx0ID0gcmVzdGF1cmFudC5hbHQ7XG4gIGRlZmF1bHRJbWcuc3JjID0gREJIZWxwZXIuaW1hZ2VVcmxGb3JSZXN0YXVyYW50KHJlc3RhdXJhbnQsICdsZycpO1xuICBpbWFnZS5hcHBlbmQoZGVmYXVsdEltZyk7XG5cbiAgY29uc3QgY3Vpc2luZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXN0YXVyYW50LWN1aXNpbmUnKTtcbiAgY3Vpc2luZS5pbm5lckhUTUwgPSByZXN0YXVyYW50LmN1aXNpbmVfdHlwZTtcblxuICAvLyBmaWxsIG9wZXJhdGluZyBob3Vyc1xuICBpZiAocmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpIHtcbiAgICBmaWxsUmVzdGF1cmFudEhvdXJzSFRNTCgpO1xuICB9XG4gIC8vIGZpbGwgcmV2aWV3c1xuICBmaWxsUmV2aWV3c0hUTUwoKTtcbn1cblxuLyoqXG4gKiBDcmVhdGUgcmVzdGF1cmFudCBvcGVyYXRpbmcgaG91cnMgSFRNTCB0YWJsZSBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuICovXG5maWxsUmVzdGF1cmFudEhvdXJzSFRNTCA9IChvcGVyYXRpbmdIb3VycyA9IHNlbGYucmVzdGF1cmFudC5vcGVyYXRpbmdfaG91cnMpID0+IHtcbiAgY29uc3QgaG91cnMgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcucmVzdGF1cmFudC1ob3VycycpO1xuICBmb3IgKGxldCBrZXkgaW4gb3BlcmF0aW5nSG91cnMpIHtcbiAgICBjb25zdCByb3cgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0cicpO1xuXG4gICAgY29uc3QgZGF5ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgndGQnKTtcbiAgICBkYXkuaW5uZXJIVE1MID0ga2V5O1xuICAgIHJvdy5hcHBlbmRDaGlsZChkYXkpO1xuXG4gICAgY29uc3QgdGltZSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3RkJyk7XG4gICAgdGltZS5pbm5lckhUTUwgPSBvcGVyYXRpbmdIb3Vyc1trZXldO1xuICAgIHJvdy5hcHBlbmRDaGlsZCh0aW1lKTtcblxuICAgIGhvdXJzLmFwcGVuZENoaWxkKHJvdyk7XG4gIH1cbn1cblxuLyoqXG4gKiBDcmVhdGUgYWxsIHJldmlld3MgSFRNTCBhbmQgYWRkIHRoZW0gdG8gdGhlIHdlYnBhZ2UuXG4gKi9cbmZpbGxSZXZpZXdzSFRNTCA9IChyZXZpZXdzID0gc2VsZi5yZXN0YXVyYW50LnJldmlld3MpID0+IHtcbiAgY29uc3QgY29udGFpbmVyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnJldmlld3MtY29udGFpbmVyJyk7XG5cbiAgaWYgKCFyZXZpZXdzKSB7XG4gICAgY29uc3Qgbm9SZXZpZXdzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICAgIG5vUmV2aWV3cy5pbm5lckhUTUwgPSAnTm8gcmV2aWV3cyB5ZXQhJztcbiAgICBjb250YWluZXIuYXBwZW5kQ2hpbGQobm9SZXZpZXdzKTtcbiAgICByZXR1cm47XG4gIH1cblxuICBjb25zdCB1bCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5yZXZpZXdzLWxpc3QnKTtcblxuICByZXZpZXdzLmZvckVhY2gocmV2aWV3ID0+IHtcbiAgICB1bC5hcHBlbmRDaGlsZChjcmVhdGVSZXZpZXdIVE1MKHJldmlldykpO1xuICB9KTtcblxuICBjb250YWluZXIuYXBwZW5kQ2hpbGQodWwpO1xufVxuXG4vKipcbiAqIENyZWF0ZSByZXZpZXcgSFRNTCBhbmQgYWRkIGl0IHRvIHRoZSB3ZWJwYWdlLlxuICovXG5jcmVhdGVSZXZpZXdIVE1MID0gKHJldmlldykgPT4ge1xuICBjb25zdCBsaSA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ2xpJyk7XG4gIGNvbnN0IG5hbWUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIG5hbWUuaW5uZXJIVE1MID0gcmV2aWV3Lm5hbWU7XG4gIGxpLmFwcGVuZENoaWxkKG5hbWUpO1xuXG4gIGNvbnN0IGRhdGUgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCdwJyk7XG4gIGRhdGUuaW5uZXJIVE1MID0gcmV2aWV3LmRhdGU7XG4gIGxpLmFwcGVuZENoaWxkKGRhdGUpO1xuXG4gIGNvbnN0IHJhdGluZyA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoJ3AnKTtcbiAgcmF0aW5nLmlubmVySFRNTCA9IGBSYXRpbmc6ICR7cmV2aWV3LnJhdGluZ31gO1xuICBsaS5hcHBlbmRDaGlsZChyYXRpbmcpO1xuXG4gIGNvbnN0IGNvbW1lbnRzID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgncCcpO1xuICBjb21tZW50cy5pbm5lckhUTUwgPSByZXZpZXcuY29tbWVudHM7XG4gIGxpLmFwcGVuZENoaWxkKGNvbW1lbnRzKTtcblxuICByZXR1cm4gbGk7XG59XG5cbi8qKlxuICogQWRkIHJlc3RhdXJhbnQgbmFtZSB0byB0aGUgYnJlYWRjcnVtYiBuYXZpZ2F0aW9uIG1lbnVcbiAqL1xuZmlsbEJyZWFkY3J1bWIgPSAocmVzdGF1cmFudD1zZWxmLnJlc3RhdXJhbnQpID0+IHtcbiAgY29uc3QgYnJlYWRjcnVtYiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5icmVhZGNydW1iJyk7XG4gIGNvbnN0IGxpID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnbGknKTtcbiAgbGkuaW5uZXJIVE1MID0gcmVzdGF1cmFudC5uYW1lO1xuICBicmVhZGNydW1iLmFwcGVuZENoaWxkKGxpKTtcbn1cblxuLyoqXG4gKiBHZXQgYSBwYXJhbWV0ZXIgYnkgbmFtZSBmcm9tIHBhZ2UgVVJMLlxuICovXG5nZXRQYXJhbWV0ZXJCeU5hbWUgPSAobmFtZSwgdXJsKSA9PiB7XG4gIGlmICghdXJsKVxuICAgIHVybCA9IHdpbmRvdy5sb2NhdGlvbi5ocmVmO1xuICBuYW1lID0gbmFtZS5yZXBsYWNlKC9bXFxbXFxdXS9nLCAnXFxcXCQmJyk7XG4gIGNvbnN0IHJlZ2V4ID0gbmV3IFJlZ0V4cChgWz8mXSR7bmFtZX0oPShbXiYjXSopfCZ8I3wkKWApLFxuICAgIHJlc3VsdHMgPSByZWdleC5leGVjKHVybCk7XG4gIGlmICghcmVzdWx0cylcbiAgICByZXR1cm4gbnVsbDtcbiAgaWYgKCFyZXN1bHRzWzJdKVxuICAgIHJldHVybiAnJztcbiAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudChyZXN1bHRzWzJdLnJlcGxhY2UoL1xcKy9nLCAnICcpKTtcbn1cbiJdfQ==
